<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap-clearmin.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/roboto.css">
    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.min.css">
    <script src="assets/js/lib/jquery-2.1.3.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <title>Tasty Menu Sign Up</title>
    <style></style>
  </head>
  <body class="cm-login">

    <div class="col-sm-6 col-md-4 col-lg-3" style="margin: 100px auto; float: none;">
      <h2>Sign Up </h2>
      <form>
      <label>用户名</label>
      <input type="text" id="username_signup" class="span3">
      <label>密码</label>
      <input type="password" id="password_signup" class="span3">
      <label>确认密码</label>
      <input type="password" id="password2_signup" class="span3">
      <label>餐厅名称</label>
      <input type="text" id="rest_name_signup" class="span3">
      
      <label>餐厅地址</label>
      <input type="text" id="rest_location_signup" class="span3">
      <label>餐厅电话</label>
      <input type="text" id="phone_signup" class="span3">
      <label>拥有者</label>
      <input type="text" id="owner_signup" class="span3">
      <label>Clover Id</label>
      <input type="text" id="cloverid_signup" class="span3">
      <label>Clover Access Token</label>
      <input type="text" id="token_signup" class="span3">
      <input type="submit" onclick="return signup()" value="Sign up" class="btn btn-primary span3">
      <div class="clearfix"></div>
      </form>
    </div>
    <script type="text/javascript">
      function signup(){
        if($("#password_signup").val() != $("#password2_signup").val()) {
            alert("Password doesn't match.");
            return;
        } else{
            var url = "/api/v1/admin/createLogin";
            var body = {
              "username": $("#username_signup").val(),
              "password": $("#password_signup").val(),
              "name": $("#rest_name_signup").val(),
              "location": $("#rest_location_signup").val(),
              "phone": $("#phone_signup").val(),
              "owner": $("#owner_signup").val(),
              "cloverId": $("#cloverid_signup").val(),
              "accessToken": $("#token_signup").val()
            };

            $.ajax({
                url: url,
                type: 'POST',
                dataType: 'text',
                data: JSON.stringify(body),
                async: false,
                contentType: 'application/json',
                success: function (data) {
                    console.log(data)

                    sessionStorage.setItem("username", $("#username_signup").val());
                    $(window).attr('location', 'index.html');
                },
                fail: function (jqXHR, textStatus, err) {
                    alert("系统繁忙，请稍后再试");
                },
                complete: function (response, textStatus) {
                    return alert("Hey: " + textStatus);
                }
            })
        }
      }
      </script>
  </body>
</html>
